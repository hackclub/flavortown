<aside class="sidebar" aria-label="Main">
  <%# <div class="sidebar__header">
    <span class="sidebar__title">Flavortown</span>
  </div> %>

  <div class="sidebar__blob">
    <nav class="sidebar__nav" aria-label="Primary navigation">
      <% sidebar_nav_items = [
        { label: "Kitchen", path: kitchen_path, icon: "fork_spoon_fill" },
        # { label: "Explore", path: "#", icon: "compass_fill" },
        { label: "Projects", path: projects_path, icon: "square_fill" },
        { label: "Vote", path: new_vote_path, icon: "star_fill" },
        { label: "Shop", path: "/shop", icon: "shopping_cart_1_fill" }
      ] %>

      <% sidebar_nav_items << { label: "Admin", path: admin_root_path, icon: "code" } if policy(:admin).access_admin_dashboard? %>

      <ul class="sidebar__nav-list">
        <% sidebar_nav_items.each do |item| %>
          <% candidate_path = item[:path] %>
          <% active = if candidate_path == "#"
                        false
                      else
                        current_page?(candidate_path) ||
                          request.path == candidate_path ||
                          request.path.start_with?("#{candidate_path}/")
                      end %>
          <% link_classes = ["sidebar__nav-link", ("sidebar__nav-link--active" if active)].compact.join(" ") %>

          <li class="sidebar__nav-item">
            <%= link_to item[:path], class: link_classes, aria: (active ? { current: "page" } : {}) do %>
              <span class="sidebar__nav-icon-wrapper" aria-hidden="true">
              <%= inline_svg_tag "icons/#{item[:icon]}.svg", class: "sidebar__nav-icon" %>
              </span>
              <span class="sidebar__nav-label"><%= item[:label] %></span>
            <% end %>
          </li>
        <% end %>
      </ul>
    </nav>
  </div>

  <div class="sidebar__user" aria-live="polite">
    <div class="sidebar__user-card">
      <div class="sidebar__user-avatar">
        <%= image_tag "chef-hat.webp", alt: "Hat", class: "sidebar__user-avatar-hat", aria: { hidden: true } %>
        <%= image_tag "chef-hat-bg.webp", alt: "Hat", class: "sidebar__user-avatar-hat-bg", aria: { hidden: true } %>
        <% if current_user.slack_id.present? %>
          <%= image_tag "http://cachet.dunkirk.sh/users/#{current_user.slack_id}/r", alt: current_user.display_name, class: "sidebar__user-avatar-placeholder", style: "object-fit: cover;" %>
        <% else %>
          <div class="sidebar__user-avatar-placeholder">
            <%= current_user.display_name.first.upcase %>
          </div>
        <% end %>
      </div>
      <div class="sidebar__user-details">
        <span class="sidebar__user-name"><%= current_user.display_name %></span>
        <span class="sidebar__user-balance">üç™ <%= current_user.balance %></span>
      </div>
    </div>
  </div>
</aside>
