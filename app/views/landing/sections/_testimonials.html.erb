<div class="section testimonials">
  <div class="ribbon ribbon-title title">What past chefs say</div>

  <% cards_markup = capture do %>
      <div class="testimonial red">
        <h2>18 year old Hack Clubber from Japan</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-1.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>I spent over 400 hours at High Seas ... and connected with people from all over the world ... these led to incredible opportunities, like participating in DEFCON...</h3>
        </div>
      </div>
      <div class="testimonial yellow">
        <h2>17 year old Hack Clubber from India</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-2.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>I found a community of teens working on incredible projects, which helped me out of my comfort zone, from just software to even hardware and automation.</h3>
        </div>
      </div>
      <div class="testimonial green">
        <h2>17 year old Hack Clubber from Japan</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-3.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>High Seas motivated me to start my own Hack Club ... it’s also helped me grow, making me less shy, more connected, and even making friends online and in real life.</h3>
        </div>
      </div>
      <div class="testimonial yellow">
        <h2>17 year old Hack Clubber from Egypt</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-4.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>One of the best events I’ve ever joined ... I met amazing people and finally found motivation ... huge thanks to everyone who made High Seas such a special experience!</h3>
        </div>
      </div>
      <div class="testimonial red">
        <h2>18 year old Hack Clubber from Japan</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-1.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>I spent over 400 hours at High Seas ... and connected with people from all over the world ... these led to incredible opportunities, like participating in DEFCON...</h3>
        </div>
      </div>
      <div class="testimonial yellow">
        <h2>17 year old Hack Clubber from India</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-2.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>I found a community of teens working on incredible projects, which helped me out of my comfort zone, from just software to even hardware and automation.</h3>
        </div>
      </div>
      <div class="testimonial green">
        <h2>17 year old Hack Clubber from Japan</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-3.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>High Seas motivated me to start my own Hack Club ... it’s also helped me grow, making me less shy, more connected, and even making friends online and in real life.</h3>
        </div>
      </div>
      <div class="testimonial yellow">
        <h2>17 year old Hack Clubber from Egypt</h2>
        <div class="content">
          <%= image_tag "landing/testimonials/cards/card-4.webp", alt: "Summer of Making", loading: "lazy" %>
          <h3>One of the best events I’ve ever joined ... I met amazing people and finally found motivation ... huge thanks to everyone who made High Seas such a special experience!</h3>
        </div>
      </div>
    <% end %>

  <div class="cards">
    <div class="cards-track">
      <%= cards_markup %>  <%# Only one set now %>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const track = document.querySelector('.cards-track');
      if (!track) return;

      const originalCards = Array.from(track.children);
      if (originalCards.length === 0) return;

      const fragment = document.createDocumentFragment();
      originalCards.forEach(card => fragment.appendChild(card.cloneNode(true)));
      track.appendChild(fragment);

      const measureLoopWidth = () => track.scrollWidth / 2;
      let loopWidth = measureLoopWidth();
      let position = 0;
      const speed = 1;
      let isPaused = false;

      function scroll() {
        if (!isPaused) {
          position -= speed;
          if (Math.abs(position) >= loopWidth) position = 0;
          track.style.transform = `translateX(${position}px)`;
        }
        requestAnimationFrame(scroll);
      }

      scroll();
      window.addEventListener('resize', () => (loopWidth = measureLoopWidth()));

      const cardsContainer = document.querySelector('.cards');
      if (!cardsContainer) return;
      cardsContainer.addEventListener('mouseenter', () => (isPaused = true));
      cardsContainer.addEventListener('mouseleave', () => (isPaused = false));
    });
  </script>
</div>
