<h1 style="text-align: center; margin: 0.5em;">Suspicious Votes</h1>

<div class="card">
  <table class="table-data">
    <thead>
      <tr>
        <th>#</th>
        <th>User</th>
        <th>Suspicious Votes</th>
        <th>Last Updated</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each_with_index do |user, idx| %>
        <tr>
          <td><%= idx + 1 %></td>
          <td><%= link_to user.display_name || "User ##{user.id}", admin_user_path(user) %></td>
          <td><%= user.suspicious_votes_count %></td>
          <td>
            <% if timestamp = @voting_lock_timestamps[user.id] %>
              <%= time_ago_in_words(timestamp) %> ago
            <% else %>
              <span class="text-muted">—</span>
            <% end %>
          </td>
          <td>
            <%= link_to "View Votes", votes_admin_user_path(user), class: "btn-primary slim" %>
            <%= button_to toggle_voting_lock_admin_user_path(user), 
                  method: :post, 
                  class: "btn-secondary slim",
                  title: user.voting_locked? ? "Unlock Voting" : "Lock Voting" do %>
              <%= user.voting_locked? ? "Unlock" : "Lock" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<br>
<%= link_to "← Back to Admin", admin_root_path, class: "btn-secondary" %>