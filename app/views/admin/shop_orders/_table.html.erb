<% if orders.any? %>
  <div class="card">
    <table class="table-data">
      <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Item</th>
          <th>Qty</th>
          <th>Tickets</th>
          <th>Status</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% orders.each do |order| %>
          <% can_see = order.can_view_address?(current_user) %>
          <tr>
            <td>#<%= order.id %></td>
            <td>
              <%= link_to order.user.display_name || "Unknown", admin_user_path(order.user), class: "btn-primary slim" %><br>
              <small style="color: #6b7280;"><%= order.user.email %></small>
            </td>
            <td>
              <%= order.shop_item.name %><br>
              <small style="color: #6b7280;"><%= order.shop_item.type&.demodulize %></small>
            </td>
            <td><%= order.quantity %></td>
            <td><%= order.total_cost %></td>
            <td>
              <span class="badge badge-<%= order.aasm_state %>">
                <%= order.aasm_state.humanize %>
              </span>
              <% if order.aasm_state == "fulfilled" %>
                <br><small style="color: #6b7280;">Shipped to user</small>
              <% end %>
            </td>

            <td>
              <%= order.created_at.strftime("%b %d, %Y") %><br>
              <small style="color: #6b7280;"><%= order.created_at.strftime("%l:%M %p") %></small>
            </td>
            <td>
              <%= link_to "Inspect", admin_shop_order_path(order), class: "btn-primary slim" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <div class="card">
    <p>No orders found matching the filters.</p>
  </div>
<% end %>
