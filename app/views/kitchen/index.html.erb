<div class="kitchen-index">
  <%= render HeadingComponent.new(title: "Kitchen", tone: :blue) %>

  <% if current_user&.banned? %>
    <div class="banned-banner">
      <div class="banned-banner__content">
        <h2 class="banned-banner__title">Account Banned</h2>
        <p class="banned-banner__message">Your account has been banned and you cannot access other parts of the site.</p>
        <% if current_user.banned_reason.present? %>
          <p class="banned-banner__reason"><strong>Reason:</strong> <%= current_user.banned_reason %></p>
        <% end %>
      </div>
    </div>
  <% else %>
  <% if current_user.verification_ineligible? %>
    <div class="kitchen-verification-notice kitchen-verification-notice--compact kitchen-verification-notice--wide">
      <%= render StateCardComponent.new(
        title: "Not Eligible",
        description: "Your account has been marked as ineligible for this program. If you believe this is an error, please contact identity@hackclub.com.",
        variant: :danger,
        badge_text: "ineligible",
        icon: "info"
      ) %>
    </div>
  <% elsif current_user.verification_verified? && current_user.ysws_eligible == false %>
    <div class="kitchen-verification-notice kitchen-verification-notice--compact kitchen-verification-notice--wide">
      <%= render StateCardComponent.new(
        title: "Outside age range",
        description: "You're verified, but this program is only available to teenagers :-/",
        variant: :warning,
        badge_text: "sorry...",
        icon: "info"
      ) %>
    </div>
  <% elsif current_user.verification_needs_submission? && current_user.tutorial_step_completed?(:identity_verified) %>
    <div class="kitchen-verification-notice kitchen-verification-notice--compact kitchen-verification-notice--wide">
      <% rejection_message = [@verification_rejection_reason&.dig("reason")&.humanize, @verification_rejection_reason&.dig("details")].compact_blank.join(": ").presence %>
      <%= render StateCardComponent.new(
        title: "one more try!",
        description: "we need you to resubmit your ID verification..." + (rejection_message ? " #{rejection_message}" : ""),
        variant: :danger,
        badge_text: "action needed",
        icon: "info",
        cta_text: "verify again",
        cta_href: HCAService.verify_portal_url(return_to: kitchen_url)
      ) %>
    </div>
  <% end %>
  <div class="kitchen-setup">
    <%= render KitchenTutorialStepsComponent.new(
      tutorial_steps: @tutorial_steps,
      completed_steps: @completed_steps,
      current_user: current_user
    ) %>
  </div>
  <% if current_user.verification_pending? %>
    <div class="kitchen-verification-notice kitchen-verification-notice--compact">
      <%= render StateCardComponent.new(
        title: "Verification Pending",
        description: "Your identity verification is being reviewed. This usually takes a few days.",
        variant: :warning,
        badge_text: "Pending",
        icon: "time"
      ) %>
    </div>
  <% end %>
  <% end %>
</div>
