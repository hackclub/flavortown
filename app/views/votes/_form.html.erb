<%= form_with(url: votes_path, data: { turbo: false, action: "submit->vote-tracker#submit" }) do |form| %>
  <%= form.hidden_field :project_id, value: project.id %>
  <%= form.hidden_field :time_taken_to_vote, value: 0, data: { vote_tracker_target: "timeField" } %>
  <%= form.hidden_field :repo_url_clicked, value: false, data: { vote_tracker_target: "repoField" } %>
  <%= form.hidden_field :demo_url_clicked, value: false, data: { vote_tracker_target: "demoField" } %>

  <% Vote::Category.all.each do |category| %>
    <%= fields_for "votes[]", Vote.new, index: category.id do |vote_fields| %>
      <%= render "category", fields: vote_fields, category: category %>
    <% end %>
  <% end %>

  <% if current_user.send_votes_to_slack %>
    <div class="vote-reason">
      <%= form.label :reason, "Feedback for the creator (optional)", class: "vote-reason__label" %>
      <%= form.text_area :reason, class: "vote-reason__input", placeholder: "Share your thoughts about this project...", rows: 3 %>
      <small class="vote-reason__hint">This will be shared to Slack with your vote</small>
    </div>
  <% end %>

  <%= button_tag(type: "submit", class: "btn-submit") do %>
    <%= inline_svg_tag "icons/tick.svg", class: "btn-submit__icon", aria: { hidden: true } %>
    Submit
  <% end %>
<% end %>
