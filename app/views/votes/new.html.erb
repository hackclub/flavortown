<% content_for :title, "Vote!" %>
<% if @fullstory_org_id.present? %>
  <% content_for :head do %>
    <script>
      window['_fs_host'] = 'fullstory.com';
      window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
      window['_fs_org'] = <%= @fullstory_org_id.to_json %>;
      window['_fs_namespace'] = 'FS';
      (function(){
        var s = document.createElement('script');
        s.async = true;
        s.src = 'https://' + window._fs_script;
        var first = document.getElementsByTagName('script')[0];
        first.parentNode.insertBefore(s, first);
      })();
    </script>
  <% end %>
<% end %>

<%= render MusicPlayerComponent.new(audio_url: audio_path("fireentity - voting.mp3")) %>

<div class="votes-new">
  <% if @project.nil? %>
    <p class="votes-new__no-projects">No more projects to vote on!</p>
  <% else %>
    <%= render HeadingComponent.new(title: "Vote", tone: :blue, size: :full) %>

    <div class="votes-new__main" data-controller="vote-tracker" data-action="keydown.esc->vote-tracker#closePanel">
      <%= render "project_showcase", project: @project, posts: @posts %>

      <aside
        id="votes-score-card"
        class="votes-new__score-card"
        data-vote-tracker-target="panel"
        aria-hidden="true">
        <button
          type="button"
          class="votes-new__score-card-toggle"
          data-action="click->vote-tracker#togglePanel"
          data-vote-tracker-target="toggleButton"
          aria-controls="votes-score-card"
          aria-expanded="false">
          Score Card
        </button>

        <div class="votes-new__score-card-header">
          <h2>Your grades, chef</h2>
        </div>

        <div class="votes-new__score-card-form">
          <%= render "form" %>
        </div>
      </aside>
    </div>
  <% end %>
</div>
