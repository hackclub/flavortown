<div class="votes-new__project">
  <div class="votes-new__project-card">
    <div class="votes-new__project-details">
      <% if project.banner.attached? %>
        <%= image_tag project.banner, alt: "#{project.title} banner", class: "votes-new__project-banner-image" %>
      <% end %>
      <div class="votes-new__project-card-content">
          <h1><%= project.title %></h1>
          <p><%= truncate(project.description, length: 250) %></p>
          <div class="votes-new__project-card-stats">
              <div class="votes-new__project-card-stat">
                  <%= inline_svg_tag "icons/paper.svg" %>
                  <span><%= project.devlogs_count %> devlogs</span>
              </div>
              <div class="votes-new__project-card-stat">
                  <%= inline_svg_tag "icons/time.svg" %>
                  <span><%= format_seconds(project.duration_seconds) %></span>
              </div>
          </div>
      </div>
    </div>
    <div class="votes-new__project-buttons">
        <%= render ButtonComponent.new(
          href: project.demo_url,
          color: :brown,
          variant: :borderless,
          text: "DEMO",
          icon: "icons/globe2.svg",
          aria: { label: "Demo" },
          target: "_blank",
          data: { action: "click->vote-tracker#trackDemoClick" }
        ) %>
        <%= render ButtonComponent.new(
          href: project.repo_url,
          color: :brown,
          variant: :borderless,
          text: "REPO",
          icon: "icons/code.svg",
          aria: { label: "Repo" },
          target: "_blank",
          data: { action: "click->vote-tracker#trackRepoClick" }
        ) %>
        <%= render ButtonComponent.new(
          color: :yellow,
          variant: :borderless,
          text: "REPORT",
          icon: "icons/flag.svg",
          class: "report-btn",
          aria: { label: "Report" },
          onclick: "document.getElementById('report-modal').showModal()"
        ) %>
    </div>
  </div>
  <div class="votes-new__devlogs">
    <% posts.each do |post| %>
      <%= render PostComponent.new(post: post, current_user: current_user) %>
    <% end %>
  </div>
</div>

<%= render layout: "shared/modal", locals: { id: "report-modal", title: "Report project?" } do %>
  <h2>We want good, high quality projects in Flavortown. If you believe this project violates our community guidelines, please let us know why:</h2>

  <%= form_with model: Project::Report.new, url: project_reports_path(project), local: true do |f| %>
    <div class="form-field">
      <div class="form-checkbox">
        <%= f.radio_button :reason, "low_effort", id: "report_reason_low_effort", required: true %>
        <%= f.label :reason, "Low-effort project", for: "report_reason_low_effort" %>
      </div>

      <div class="form-checkbox">
        <%= f.radio_button :reason, "undeclared_ai", id: "report_reason_undeclared_ai" %>
        <%= f.label :reason, "Uses AI but it's undeclared", for: "report_reason_undeclared_ai" %>
      </div>

      <div class="form-checkbox">
        <%= f.radio_button :reason, "demo_broken", id: "report_reason_demo_broken" %>
        <%= f.label :reason, "Demo does not work", for: "report_reason_demo_broken" %>
      </div>

      <div class="form-checkbox">
        <%= f.radio_button :reason, "other", id: "report_reason_other" %>
        <%= f.label :reason, "Other", for: "report_reason_other" %>
      </div>
    </div>

    <div class="form-group">
      <%= f.text_area :details,
            rows: 4,
            minlength: 20,
            required: true,
            class: "form-field",
            placeholder: "Share a short explanation (20+ characters)." %>
      <small>Why are you reporting this project? (20+ characters)</small>
    </div>

    <div class="modal__actions">
      <%= f.submit "Submit", class: "modal__actions-close" %>
      <button type="button" class="modal__actions-close" onclick="document.getElementById('report-modal').close()">Cancel</button>
    </div>
  <% end %>
<% end %>
