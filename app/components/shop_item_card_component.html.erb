<div class="shop-item-card<%= ' shop-item-card--out-of-stock' if out_of_stock? %><%= ' shop-item-card--on-sale' if on_sale %><%= ' shop-item-card--with-bow' if show_bow %>"
     data-categories="<%= categories.join(',') %>"
     data-regions="<%= enabled_regions.join(',') %>"
     data-shop-id="<%= item_id %>"
     data-controller="shop-wishlist"
     data-shop-wishlist-item-id-value="<%= item_id %>"
     data-shop-wishlist-item-name-value="<%= name %>"
     data-shop-wishlist-item-price-value="<%= display_price %>"
     data-shop-wishlist-item-image-value="<%= url_for(image_url) %>">
  <% if show_bow %>
    <div class="shop-item-card__bow shop-item-card__bow--top-left"></div>
    <div class="shop-item-card__bow shop-item-card__bow--top-right"></div>
    <div class="shop-item-card__bow shop-item-card__bow--bottom-left"></div>
    <div class="shop-item-card__bow shop-item-card__bow--bottom-right"></div>
  <% end %>
  <% if time_ago_text %>
    <div class="shop-item-card__time-ago">
      Added <%= time_ago_text %>
    </div>
  <% end %>
  <% if on_sale %>
    <div class="shop-item-card__sale-badge">
      <%= sale_percentage %>% OFF
    </div>
  <% end %>
  <% if show_stock_indicator? %>
    <div class="shop-item-card__stock-badge<%= ' shop-item-card__stock-badge--low' if low_stock? %><%= ' shop-item-card__stock-badge--out' if out_of_stock? %>">
      <% if out_of_stock? %>
        Out of stock
      <% else %>
        <%= remaining_stock %> left
      <% end %>
    </div>
  <% end %>
  <% if logged_in %>
    <button type="button"
            class="shop-item-card__star"
            data-shop-wishlist-target="starButton"
            data-action="click->shop-wishlist#toggle"
            aria-label="Add to goals"
            aria-pressed="false">
      <%= helpers.inline_svg_tag "icons/star_fill.svg" %>
    </button>
    <%= link_to order_url, class: "shop-item-card__link", data: { turbo_frame: "_top" } do %>
      <div class="shop-item-card__image">
        <%= image_tag image_url, alt: "#{name} image", class: "rounded-lg w-full h-auto object-scale-down aspect-square max-h-48" %>
      </div>
      <div class="shop-item-card__content">
        <h4 class="shop-item-card__title"><%= name %></h4>
        <div class="shop-item-card__description"><%= md(description) %></div>
        <div class="shop-item-card__details">
          <span class="shop-item-card__hours">‚ü© <%= hours %> hours</span>
          <div class="shop-item-card__prices">
            <% if on_sale && original_price %>
              <span class="shop-item-card__original-price"><%= number_to_currency(original_price, precision: 0).gsub('$', 'üç™') %></span>
            <% end %>
            <span class="shop-item-card__price"><%= number_to_currency(display_price, precision: 0).gsub('$', 'üç™') %></span>
          </div>
        </div>
      </div>
    <% end %>
    <div class="shop-item-card__order-button">
      <% if balance >= display_price %>
        <%= link_to "Order Now", order_url, class: "btn btn-primary w-full", data: {turbo_frame: "_top"} %>
      <% else %>
        <p class="btn btn-primary w-full"><%= number_to_currency(display_price - balance, precision: 0).gsub('$', 'üç™') %> more needed!</p>
      <% end %>
    </div>
  <% else %>
    <div class="shop-item-card__link">
      <div class="shop-item-card__image">
        <%= image_tag image_url, alt: "#{name} image", class: "rounded-lg w-full h-auto object-scale-down aspect-square max-h-48" %>
      </div>
      <div class="shop-item-card__content">
        <h4 class="shop-item-card__title"><%= name %></h4>
        <div class="shop-item-card__description"><%= md(description) %></div>
        <div class="shop-item-card__details">
          <span class="shop-item-card__hours">‚ü© <%= hours %> hours</span>
          <div class="shop-item-card__prices">
            <% if on_sale && original_price %>
              <span class="shop-item-card__original-price"><%= number_to_currency(original_price, precision: 0).gsub('$', 'üç™') %></span>
            <% end %>
            <span class="shop-item-card__price"><%= number_to_currency(display_price, precision: 0).gsub('$', 'üç™') %></span>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
